Feature: JWT секрет и ротация
Scenario: Отсутствие SECRET_KEY приводит к fail-fast
Given переменная окружения SECRET_KEY не задана
When приложение стартует
Then процесс завершается с ошибкой до старта HTTP-сервера

Scenario: Секрет JWT ротирован не реже одного раза в 90 дней
Given в хранилище секретов зафиксирована дата последней ротации
When выполняется проверка политики секрета в CI
Then возраст секрета ≤ 90 дней, иначе пайплайн помечается failed

Feature: Rate limiting
Scenario: Ограничение POST-запросов по IP
Given включён лимитер запросов
When один IP выполняет более 10 POST-запросов за 1 минуту
Then запросы сверх лимита получают HTTP 429, заголовок Retry-After присутствует

Feature: Контроль владения
Scenario: PUT/DELETE идеи доступен только владельцу
Given идея принадлежит пользователю A, а пользователь B аутентифицирован
When B отправляет PUT или DELETE на /api/ideas/{id}
Then возвращается HTTP 403 Forbidden
